(function(c){c.visualize={plugins:{}};Array.max=function(d){return Math.max.apply(Array,d)};Array.min=function(d){return Math.min.apply(Array,d)};Array.sum=function(e){var d=(e&&e.length?e.length:0),g=0,h;for(var f=0;f<d;f++){h=parseFloat(e[f]);g+=((!e[f]||isNaN(e[f]))?0:h)}return g};Array.avg=function(e){var d=(e&&e.length?e.length:0);return(d?Array.sum(e)/d:0)};function b(g,f,e){if(g[f]){console.log("Executing existing chart "+f);g[f]()}else{if(c.visualize.plugins[f]){c.visualize.plugins[f].apply(e)}else{console.log("Trying to load jquery.vizualize."+f+".js");c.getScript("./js/jquery.visualize."+f.split(/[-_]/)[0]+".js",function d(){c.visualize.plugins[f].apply(e)}).fail(function(j,i,h){e.target.canvasContainer.remove();if(console.log){console.log("Failed to load jquery.vizualize plugin "+f+" in following location : ./js/jquery.visualize."+f.split(/[-_]/)[0]+".js\n"+h)}})}}}function a(e,d){this.table=c(e);this.options=d}a.prototype={dataGroups:function(){if(this._dataGroups){return this._dataGroups}var g=[];var f=this.options.colors,k=this.options.textColors,d=this.options.rowFilter,e=this.options.colFilter;if(this.options.parseDirection=="x"){this.table.find("tr:gt(0)").filter(d).each(function(l,m){g[l]={};g[l].points=[];g[l].points_weight=[];g[l].color=f[l];if(k[l]){g[l].textColor=k[l]}c(m).find("td").filter(e).each(function(){var i=c(this).text().split(";");g[l].points.push(i.length>0?parseFloat(i[0]):0);g[l].points_weight.push(i.length>1?parseFloat(i[1]):1)})})}else{var j=this.table.find("tr:eq(1) td").filter(e).size();for(var h=0;h<j;h++){g[h]={};g[h].points=[];g[h].points_weight=[];g[h].color=f[h];if(k[h]){g[h].textColor=k[h]}this.table.find("tr:gt(0)").filter(d).each(function(){var i=c(this).find("td").filter(e).eq(h).text().split(";");g[h].points.push(i.length>0?parseFloat(i[0]):0);g[h].points_weight.push(i.length>1?parseFloat(i[1]):1)})}}return(this._dataGroups=g)},allData:function(){if(this._allData){return this._allData}var d=[];c(this.dataGroups()).each(function(){d.push.apply(d,this.points)});return(this._allData=d)},dataSum:function(){if(this._dataSum){return this._dataSum}return(this._dataSum=Array.sum(this.allData()))},topValue:function(){if(this._topValue){return this._topValue}return(this._topValue=Array.max(this.allData()))},bottomValue:function(){if(this._bottomValue){return this._bottomValue}return(this._bottomValue=Array.min(this.allData()))},memberTotals:function(){if(this._memberTotals){return this._memberTotals}var e=[];var d=this.dataGroups();c.each(d,function(f,g){e.push(Array.sum(g.points))});return(this._memberTotals=e)},groupSums:function(){if(this._groupSums){return this._groupSums}var d=[];var e=this.dataGroups();for(var j=0;j<e.length;j++){var g=e[j].points;for(var f=0;f<g.length;f++){if(typeof(d[f])=="undefined"){d[f]=0}d[f]+=parseFloat(g[f])}}return(this._groupSums=d)},totalYRange:function(){return this.topValue()-this.bottomValue()},xLabels:function(){if(this._xLabels){return this._xLabels}var d=[];if(this.options.parseDirection=="x"){this.table.find("tr:eq(0) th").filter(this.options.colFilter).each(function(e,f){d.push(c(f).html())})}else{this.table.find("tr:gt(0) th").filter(this.options.rowFilter).each(function(e,f){d.push(c(f).html())})}return(this._xLabels=d)},yLabels:function(i,d){var e=d-i,h=[];h.push(i);var g=Math.round(this.options.height/this.options.yLabelInterval);var f=Math.ceil(e/g)||1;while(h[h.length-1]<d-f){h.push(h[h.length-1]+f)}h.push(d);return h},yLabels100:function(){if(this._yLabels100){return this._yLabels100}var f=[0];var e=Math.round(this.options.height/this.options.yLabelInterval);var d=Math.ceil(100/e)||1;while(f[f.length-1]<100-d){f.push(f[f.length-1]+d)}f.push(100);return(this._yLabels100=f)}};c.fn.visualize=function(e,d){return c(this).each(function(){var r=c(this);var u=c.extend({type:"bar",width:c(this).width(),height:c(this).height(),appendTitle:true,title:null,appendKey:true,rowFilter:" ",colFilter:" ",colors:["#be1e2d","#666699","#92d5ea","#ee8310","#8d10ee","#5a3b16","#26a4ed","#f45a90","#e9e744"],textColors:[],parseDirection:"x",pieMargin:20,pieLabelsAsPercent:true,pieLabelPos:"inside",lineWeight:4,barGroupMargin:10,barMargin:1,yLabelInterval:30},e);u.width=parseFloat(u.width);u.height=parseFloat(u.height);var x={pie:function(){n.addClass("visualize-pie");if(u.pieLabelPos=="outside"){n.addClass("visualize-pie-outside")}var E=Math.round(j.width()/2);var D=Math.round(j.height()/2);var o=D-u.pieMargin;var C=0;var F=c('<ul class="visualize-labels"></ul>').insertAfter(j);c.each(q,function(L,N){var R=(N<=0||isNaN(N))?0:N/p;v.beginPath();v.moveTo(E,D);v.arc(E,D,o,C*Math.PI*2-Math.PI*0.5,(C+R)*Math.PI*2-Math.PI*0.5,false);v.lineTo(E,D);v.closePath();v.fillStyle=g[L].color;v.fill();var P=(C+R/2);var G=u.pieLabelPos=="inside"?o/1.5:o+o/5;var K=Math.round(E+Math.sin(P*Math.PI*2)*(G));var J=Math.round(D-Math.cos(P*Math.PI*2)*(G));var H=(K>E)?"right":"left";var I=(J>D)?"bottom":"top";var S=parseFloat((R*100).toFixed(2));if(S){var M=(u.pieLabelsAsPercent)?S+"%":N;var Q=c('<span class="visualize-label">'+M+"</span>").css(H,0).css(I,0);var O=c('<li class="visualize-label-pos"></li>').appendTo(F).css({left:K,top:J}).append(Q);Q.css("font-size",o/8).css("margin-"+H,-Q.width()/2).css("margin-"+I,-Q.outerHeight()/2);if(g[L].textColor){Q.css("color",g[L].textColor)}}C+=R})},line:function(F){if(F){n.addClass("visualize-area")}else{n.addClass("visualize-line")}var G=j.width()/(t.length-1);var D=c('<ul class="visualize-labels-x"></ul>').width(j.width()).height(j.height()).insertBefore(j);c.each(t,function(J){var H=c("<li><span>"+this+"</span></li>").prepend('<span class="line" />').css("left",G*J).appendTo(D);var I=H.find("span:not(.line)");var K=I.width()/-2;if(J==0){K=0}else{if(J==t.length-1){K=-I.width()}}I.css("margin-left",K).addClass("label")});var E=j.height()/f;var o=j.height()/(A.length-1);var C=c('<ul class="visualize-labels-y"></ul>').width(j.width()).height(j.height()).insertBefore(j);c.each(A,function(K){var H=c("<li><span>"+this+"</span></li>").prepend('<span class="line" />').css("bottom",o*K).prependTo(C);var I=H.find("span:not(.line)");var J=I.height()/-2;if(K==0){J=-I.height()}else{if(K==A.length-1){J=0}}I.css("margin-top",J).addClass("label")});v.translate(0,h);c.each(g,function(J){v.beginPath();v.lineWidth=u.lineWeight;v.lineJoin="round";var I=this.points;var H=0;v.moveTo(0,-(I[0]*E));c.each(I,function(){v.lineTo(H,-(this*E));H+=G});v.strokeStyle=this.color;v.stroke();if(F){v.lineTo(H,0);v.lineTo(0,0);v.closePath();v.fillStyle=this.color;v.globalAlpha=0.3;v.fill();v.globalAlpha=1}else{v.closePath()}})},area:function(){this.line(true)},bar:function(){n.addClass("visualize-bar");var J=j.width()/(t.length);var F=c('<ul class="visualize-labels-x"></ul>').width(j.width()).height(j.height()).insertBefore(j);c.each(t,function(O){var N=c('<li><span class="label">'+this+"</span></li>").prepend('<span class="line" />').css("left",J*O).width(J).appendTo(F)});var o=j.height()/f;var G=j.height()/(A.length-1);var L=c('<ul class="visualize-labels-y"></ul>').width(j.width()).height(j.height()).insertBefore(j);c.each(A,function(Q){var N=c("<li><span>"+this+"</span></li>").prepend('<span class="line" />').css("bottom",G*Q).prependTo(L);var O=N.find("span:not(.line)");var P=O.height()/-2;if(Q==0){P=-O.height()}else{if(Q==A.length-1){P=0}}O.css("margin-top",P).addClass("label")});v.translate(0,h);for(var E=0;E<g.length;E++){v.beginPath();var H=(J-u.barGroupMargin*2)/g.length;var I=H-(u.barMargin*2);v.lineWidth=I;var K=g[E].points;var D=0;for(var C=0;C<K.length;C++){var M=(D-u.barGroupMargin)+(E*H)+H/2;M+=u.barGroupMargin*2;v.moveTo(M,0);v.lineTo(M,Math.round(-K[C]*o));D+=J}v.strokeStyle=g[E].color;v.stroke();v.closePath()}}};var m=document.createElement("canvas");m.setAttribute("height",u.height);m.setAttribute("width",u.width);var j=c(m);var B=u.title||r.find("caption").text();var n=(d||c('<div class="visualize" role="img" aria-label="Chart representing data from the table: '+B+'" />')).height(u.height).width(u.width).append(j);var i=new a(r,u);var g=i.dataGroups();var z=i.allData();var p=i.dataSum();var s=i.topValue();var l=i.bottomValue();var q=i.memberTotals();var f=i.totalYRange();var h=u.height*(s/f);var t=i.xLabels();var A=i.yLabels(l,s);if(u.appendTitle||u.appendKey){var k=c('<div class="visualize-info"></div>').appendTo(n)}if(u.appendTitle){c('<div class="visualize-title">'+B+"</div>").appendTo(k)}if(u.appendKey){var y=c('<ul class="visualize-key"></ul>');var w;if(u.parseDirection=="x"){w=r.find("tr:gt(0) th").filter(u.rowFilter)}else{w=r.find("tr:eq(0) th").filter(u.colFilter)}w.each(function(o){c('<li><span class="visualize-key-color" style="background: '+g[o].color+'"></span><span class="visualize-key-label">'+c(this).text()+"</span></li>").appendTo(y)});y.appendTo(k)}if(!d){n.insertAfter(r)}if(typeof(G_vmlCanvasManager)!="undefined"){G_vmlCanvasManager.init();G_vmlCanvasManager.initElement(j[0])}var v=j[0].getContext("2d");b(x,u.type,{target:{canvasContainer:n,canvasContext:v,canvas:j},data:i,options:u});c(".visualize-line li:first-child span.line, .visualize-line li:last-child span.line, .visualize-area li:first-child span.line, .visualize-area li:last-child span.line, .visualize-bar li:first-child span.line,.visualize-bar .visualize-labels-y li:last-child span.line").css("border","none");if(!d){n.bind("visualizeRefresh",function(){r.visualize(u,c(this).empty())})}}).next()}})(jQuery);$.visualize.plugins.radar=function(){var b=this.options,a=this.target.canvasContainer,m=this.target.canvasContext,c=this.target.canvas,e=this.data.dataGroups(),l=e.length,d=this.data.memberTotals(),g=this.data.topValue();a.addClass("visualize-pie");if(b.pieLabelPos=="outside"){a.addClass("visualize-pie-outside")}var h=Math.round(c.width()/2);var f=Math.round(c.height()/2);var i=Math.PI*2/l;var k=(f<h?f:h)-b.pieMargin;var j=$('<ul class="visualize-labels"></ul>').insertAfter(c);$.each(d,function(n,p){var o=p/g;var q=k*o/2;m.beginPath();m.lineWidth=b.lineWeight;m.lineJoin="round";m.moveTo(h,f);m.lineTo(h+Math.cos(n*i)*q,f+Math.sin(n*i)*q);m.strokeStyle=e[n].color;m.stroke();m.closePath()});m.beginPath();m.lineWidth=1;m.lineJoin="round";m.strokeStyle=b.colors[l];m.moveTo(h+k*d[0]/g/2,f);$.each(d,function(q,u){var r=u/g;var n=k*r/2;var t=h+Math.cos(q*i)*n;var s=f+Math.sin(q*i)*n;m.lineTo(t,s);s+=(s>f?k/16:-k/16);var o=(t>h)?"right":"left";var p=(s>f)?"bottom":"top";var v=$("<span>").addClass("visualize-label").html(u).css(o,0).css(p,0).css("font-size",k/8).css("color",e[q].color);$("<li>").addClass("visualize-label-pos").css({left:t,top:s}).append(v).appendTo(j);v.css("margin-"+o,-v.width()/2).css("margin-"+p,-v.outerHeight()/2)});m.closePath();m.stroke()};(function define(){$.visualize.plugins.dots=function(){a.call(this,false)};$.visualize.plugins.wdots=function(){a.call(this,true)};function a(s){var p=this.options,m=this.target.canvasContainer,r=this.target.canvasContext,f=this.target.canvas,k=f.width(),t=f.height(),i=this.data.dataGroups(),n=this.data.xLabels(),j=this.data.topValue(),g=(this.data.bottomValue()>0)?0:this.data.bottomValue(),b=j-g,u=this.data.yLabels(g,j);m.addClass("visualize-dots");var c=k/(n.length-1);var e=$('<ul class="visualize-labels-x"></ul>').width(k).height(t).insertBefore(f);$.each(n,function(v,o){var h=$("<span class='label'></span>").html(o);$("<li>").css("left",c*v).prepend("<span class='line' />").append(h).appendTo(e);var w=h.width()/-2;if(v==0){w=0}else{if(v==n.length-1){w=-h.width()}}h.css("margin-left",w)});var d=t/b;var l=t/(u.length-1);var q=$('<ul class="visualize-labels-y"></ul>').width(k).height(t).insertBefore(f);$.each(u,function(w,o){var h=$("<span class='label'></span>").html(o);$("<li>").css("bottom",l*w).prepend("<span class='line' />").append(h).prependTo(q);var v=h.height()/-2;if(w==0){v=-h.height()}else{if(w==u.length-1){v=0}}h.css("margin-top",v)});$.each(i,function(h,o){r.fillStyle=o.color;r.strokeStyle=o.color;r.lineWidth=p.lineWeight;r.lineJoin="round";$.each(o.points,function(w,x){r.beginPath();var v=s?o.points_weight[w]:1;r.arc(w*c,-x*d+t,v,0,2*Math.PI,false);r.fill();r.stroke()})})}})();(function define(){$.visualize.plugins.pilebar=function(){a.call(this,false)};$.visualize.plugins.pilebar_100=function(){a.call(this,true)};function a(r){var s=this.options,m=this.target.canvasContainer,u=this.target.canvasContext,k=this.target.canvas,d=this.data.dataGroups(),n=this.data.xLabels(),b=this.data.groupSums(),c=Array.max(b);yLabels=(r?this.data.yLabels100():this.data.yLabels(0,c)),m.addClass("visualize-bar");var e=k.width()/(n.length);var j=$('<ul class="visualize-labels-x"></ul>').width(k.width()).height(k.height()).insertBefore(k);$.each(n,function(A,o){var h=$("<span class='label'></span>").html(o);$("<li>").css("left",e*A).width(e).prepend("<span class='line' />").append(h).appendTo(j)});var f=k.height()/(r?100:c);var l=k.height()/(yLabels.length-1);var t=$('<ul class="visualize-labels-y"></ul>').width(k.width()).height(k.height()).insertBefore(k);$.each(yLabels,function(B,o){var h=$("<span class='label'></span>").html(o);$("<li>").css("bottom",l*B).prepend("<span class='line' />").append(h).prependTo(t);var A=h.height()/-2;if(B==0){A=-h.height()}else{if(B==yLabels.length-1){A=0}}h.css("margin-top",A)});var q=[];for(var z=0;z<d.length;z++){u.beginPath();var x=(e-s.barGroupMargin*2);var p=x-(s.barMargin*2);u.lineWidth=p;u.strokeStyle=d[z].color;var w=d[z].points;var y=0;for(var v=0;v<w.length;v++){if(typeof(q[v])=="undefined"){q[v]=s.height}var g=(y-s.barGroupMargin)+x/2;g+=s.barGroupMargin*2;u.moveTo(g,q[v]);q[v]+=Math.round(-w[v]*f*(r?100/b[v]:1));u.lineTo(g,q[v]+0.1);y+=e}u.stroke();u.closePath()}}})();